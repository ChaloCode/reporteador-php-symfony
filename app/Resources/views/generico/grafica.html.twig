
{% block stylesheetsGrafica %}    
{% endblock %}
{% block bodyGrafica %} 
     {% embed "generico/ventana.html.twig" %}                
                {% block tituloVentana %}{{info['grafica'].titulo}}{% endblock %} 
                {% block subTituloVentana %}{{info['grafica'].subtitulo}}{% endblock %}
                 {% block bodyLink %}
                    <li><a  class="fa fa-bar-chart" id="BarraLink" onclick="Barra()"> Grafica, Barra</a></li>  
                    <li><a  class="fa fa-line-chart" id="LineaLink" onclick="Linea()"> Grafica, Linea</a></li>                    
                    <li><a  class="fa fa-area-chart" id="AreaLink" onclick="Area()"> Grafica, Area</a></li>                    
                    <li><a  class="fa fa-pie-chart" id="DonutLink" onclick="Donut()"> Grafica, Donut</a></li>
                 {% endblock %}                           
                {% block bodyVentana %}                 
                    <div>
                        <p>Seleccione valores para el <strong>eje horizontal</strong></p>
                        <select id='grafica-x'>
                            {% for i in graficar %}
                                <option value="{{ loop.index0 }}">{{i}}</option>               
                            {% endfor %}
                        </select> 
                        <p>Seleccione valores para el <strong>eje vertical</strong></p>
                        <select id='grafica-y'>
                            {% for i in graficar %}
                                <option value="{{ loop.index0 }}">{{i}}</option>               
                            {% endfor %}
                        </select> 
                    </div>                
                    <div id="tap-grafica" >                              
                        <div id="Graficar" ></div>
                    </div>
               {% endblock %}
        {% endembed %}          
{% endblock %}
{% block javascriptsGrafica %}  
   <!-- moris js -->  
  <script src='{{ asset("js/moris/raphael-min.js")}}'></script>
  <script src='{{ asset("js/moris/morris.min.js")}}'></script>
  
  <script type="text/javascript">
   var datax;
   var dataAll = {        
    {% for i in 0..infoTabla['lengthFilas']   %}   
    "{{i}}" :{        
                {% for j in 0..infoTabla['lengthColumnas']  %}   
                    "{{j}}": "{{infoTabla['filas'][i][j]}}",
                {% endfor %}      
            },    
    {% endfor %}     
    };
  
  $("#grafica-x").change(function() {
      cargarGrafica();     
  });
  
   $("#grafica-y").change(function() {
        cargarGrafica();
  });
    
  function cargarGrafica()
  {
        var xx=$("#grafica-x").val();
        var yy=$("#grafica-y").val();
        var data2 = {
            'datax': []       
        };
        for (i=0;i<{{infoTabla['lengthFilas']}};i++)
        {
            data2.datax.push({ 'label':dataAll[i][xx]
                                ,'valor':dataAll[i][yy]
                                ,'value':dataAll[i][yy]
                             });
        }
       // console.log(data2);
        datax=data2.datax;
       // console.log(datax);
        Barra();
  }

  function ResetTapGrafica()
  {
      $('#Graficar').remove();
      $('#tap-grafica').append( '<div id="Graficar" ></div>' );
  }
  function Linea()
  {     
       ResetTapGrafica()
       Morris.Line({
            // ID of the element in which to draw the chart.
            element: 'Graficar',
            // Chart data records -- each entry in this array corresponds to a point on
            // the chart.
            data: datax,
            // The name of the data record attribute that contains x-values.
            xkey: 'label',
            // A list of names of data record attributes that contain y-values.
            ykeys: ['valor'],
            // Labels for the ykeys -- will be displayed when you hover over the
            // chart.
            labels: ['valor']
            
            
            });
  }
  
  function Area()
  {
      ResetTapGrafica()
     //$('#AreaLink').removeAttr('onclick');
      Morris.Area({
            // ID of the element in which to draw the chart.
            element: 'Graficar',
            // Chart data records -- each entry in this array corresponds to a point on
            // the chart.
            data: datax,
            // The name of the data record attribute that contains x-values.
            xkey: 'label',
            // A list of names of data record attributes that contain y-values.
            ykeys: ['valor'],
            // Labels for the ykeys -- will be displayed when you hover over the
            // chart.
            labels: ['valor']
            });
  }
  
  function Barra()
  {
       ResetTapGrafica()
       Morris.Bar({
            // ID of the element in which to draw the chart.
            element: 'Graficar',
            // Chart data records -- each entry in this array corresponds to a point on
            // the chart.
            data: datax,
            // The name of the data record attribute that contains x-values.
            xkey: 'label',
            // A list of names of data record attributes that contain y-values.
            ykeys: ['valor'],
            // Labels for the ykeys -- will be displayed when you hover over the
            // chart.
            labels: ['valor']
            });
  }
  
  function Donut()
  {
         ResetTapGrafica()
         Morris.Donut({
            // ID of the element in which to draw the chart.
            element: 'Graficar',
            data: datax,                    
            formatter: function (y) {
                return y + "%"
            }
      });
  }
      //Linea();
        //Area();
      // Barra();
       // Donut();
       cargarGrafica();
  </script>
{% endblock %}
